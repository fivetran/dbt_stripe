version: 2

models:
  - name: stripe__balance_transactions
    description: Each record represents a change to your account balance, enriched with data about the transaction.
    columns:
    - name: balance_transaction_id 
      description: Unique identifier for the transaction. 
      tests:
        - unique
    - name: created_at 
      description: When the transaction took place
    - name: available_on 
      description: The date the transaction’s net funds will become available in the Stripe balance.
    - name: currency 
      description: Three-letter ISO currency code, in lowercase.
    - name: amount 
      description: Gross amount of the transaction, in cents.
    - name: fee 
      description: Fees (in cents) paid for this transaction.
    - name: net 
      description: Net amount of the transaction, in cents.
    - name: type 
      description: The type of transaction.  Possible values are adjustment, advance, advance_funding, application_fee, application_fee_refund, charge, connect_collection_transfer, issuing_authorization_hold, issuing_authorization_release, issuing_dispute, issuing_transaction, payment, payment_failure_refund, payment_refund, payout, payout_cancel, payout_failure, refund, refund_failure, reserve_transaction, reserved_funds, stripe_fee, stripe_fx_fee, tax_fee, topup, topup_reversal, transfer, transfer_cancel, transfer_failure, or transfer_refund.
    - name: reporting_category 
      description: Groupings of transactions types based on how they show in Stripe's reporting
    - name: source 
      description: The Stripe object to which this transaction is related.
    - name: description 
      description: An arbitrary string attached to the object. Often useful for displaying to users.
    - name: customer_facing_amount 
      description: The transaction amount that the customer sees.
    - name: customer_facing_currency 
      description: Three-letter ISO currency code that the customer sees.
    - name: effective_at 
      description: calendar day after available_at
    - name: customer_id 
      description: The customer associated with the balance transaction (based on charge or refund details)
    - name: receipt_email 
      description: The email the receipt was emailed to for this transaction.
    - name: customer_description 
      description: The description field associated with the customer 
    - name: charge_id 
      description: The id of the charge associated with the balance transaction 
    - name: payment_intent_id 
      description: The id of the payment intent associated with the balance transaction 
    - name: charge_created_at 
      description: Timestamp of the charge object associated with the balance transaction 
    - name: payment_method_type 
      description: The id of the payment method type associated with the balance transaction 
    - name: payment_method_brand
      description: Card brand used for the payment method. Can be American Express, Diners Club, Discover, JCB, MasterCard, UnionPay, Visa, or Unknown.
    - name: payment_method_funding
      description: Card funding type for the payment method. Can be credit, debit, prepaid, or unknown.
    - name: card_brand 
      description: The brand of the card associated with the balance transaction 
    - name: card_funding 
      description: Card funding type. Can be credit, debit, prepaid, or unknown.
    - name: card_country 
      description: The country the card was issued in.
    - name: payout_id 
      description: ID for the payout associated with this balance transaction 
    - name: payout_expected_arrival_date
      description: Date the payout is expected to arrive in the bank. This factors in delays like weekends or bank holidays.
    - name: payout_status 
      description: Current status of the payout.  Can be paid, pending, in_transit, canceled or failed.
    - name: payout_type 
      description: Whether the payout was to a bank_account or card.
    - name: payout_description 
      description: An arbitrary string attached to the payout. Often useful for displaying to users.
    - name: refund_reason 
      description: Reason for the refund, either user-provided (duplicate, fraudulent, or requested_by_customer) or generated by Stripe internally (expired_uncaptured_charge).

  - name: stripe__customer_overview
    description: Each record represents a customer, enriched with metrics about their associated transactions.
    columns:
      - name: customer_description 
        description: An arbitrary string attached to the object. Often useful for displaying to users.
      - name: email 
        description: Email address associated with the customer.
      - name: customer_created_at 
        description: Timestamp of when the customer entry was created.
      - name: is_delinquent
        description: When the customer’s latest invoice is billed by charging automatically, delinquent is true if the invoice’s latest charge is failed. When the customer’s latest invoice is billed by sending an invoice, delinquent is true if the invoice is not paid by its due date.
      - name: total_sales 
        description: Sum of all charges made to this customer.
      - name: total_refunds 
        description: Sum of all refunds made to this customer.
      - name: total_gross_transaction_amount
        description: Gross amount of all transactions made with this customer.
      - name: total_fees 
        description: Total fees charged on all transactions made with this customer.
      - name: total_net_transaction_amount 
        description: Net amount of all transactions made with this customer.
      - name: total_sales_count 
        description: The total number of sales made to this customer.
      - name: total_refund_count 
        description: The total number of refunds made to this customer. 
      - name: sales_this_month 
        description: Sum of charges made to this customer this month.
      - name: refunds_this_month 
        description: Sum of refunds made to this customer this month.
      - name: gross_transaction_amount_this_month 
        description: Gross amount of transactions made with this customer this month.
      - name: fees_this_month 
        description: Total fees charged on transactions made with this customer this month.
      - name: net_transaction_amount_this_month 
        description: Net amount of transactions made with this customer this month.
      - name: sales_count_this_month 
        description: The number of sales made to this customer this month.
      - name: refund_count_this_month
        description: The number of refunds made to this customer this month.
      - name: first_sale_date 
        description: Date of the first time this customer was charged.
      - name: most_recent_sale_date 
        description: Date of the most recent time this customer was charged.
      - name: total_failed_charge_count
        description: The total number of incomplete charges this customer has had.
      - name: total_failed_charge_amount
        description: The total amount from incomplete charges this customer has had.
      - name: failed_charge_count_this_month
        description: The number of incomplete charges this customer has had this month.
      - name: failed_charge_amount_this_month
        description: The amount from incomplete charges this customer has had this month.
      - name: customer_currency 
        description: Currency used by the customer.
      - name: default_card_id
        description: ID of the default card used by the customer.
      - name: shipping_name 
        description: Attribute of the customer's shipping address.
      - name: shipping_address_line_1 
        description: Attribute of the customer's shipping address.
      - name: shipping_address_line_2 
        description: Attribute of the customer's shipping address.
      - name: shipping_address_city 
        description: Attribute of the customer's shipping address.
      - name: shipping_address_state 
        description: Attribute of the customer's shipping address.
      - name: shipping_address_country 
        description: Attribute of the customer's shipping address.
      - name: shipping_address_postal_code 
        description: Attribute of the customer's shipping address.
      - name: shipping_phone
        description: Attribute of the customer's shipping address.

  - name: stripe__daily_overview
    description: Each record represents a single day, enriched with metrics about balances, payments, refunds, payouts, and other transactions.
    columns:
      - name: date 
        description: The date associated with the transactions.  The available_at field is used for payouts, and the transaction created_at is used for all others.
      - name: total_sales 
        description: The sum of all sales during the reporting period.
      - name: total_refunds 
        description: The sum of all refunds during the reporting period.
      - name: total_adjustments 
        description: The sum of all adjustments during the reporting period.
      - name: total_other_transactions
        description: The sum of all other transactions during the reporting period.
      - name: total_gross_transaction_amount
        description: Gross amount of all transactions (excluding payouts and transfers)
      - name: total_net_transactions
        description: Net amount of all transactions (excluding payouts and transfers)
      - name: total_payout_fees
        description: Fees associated with all payouts and transfers during the reporting period.
      - name: total_gross_payout_amount 
        description: Total amount of all payouts and transfers during the reporting period.
      - name: daily_net_activity 
        description: Total balance transaction activity during the reporting period.
      - name: daily_end_balance 
        description: Account balance at the end of the reporting period.
      - name: total_sales_count 
        description: Number of sales transactions during the reporting period.
      - name: total_payouts_count 
        description: Number of payouts made during the reporting period.
      - name: total_adjustments_count
        description: Number of adjustments made during the reporting period.
      - name: total_failed_charge_count
        description: Number of incomplete charges during the reporting period.
      - name: total_failed_charge_amount
        description: Total amount from incomplete charges during the reporting period.

  - name: stripe__weekly_overview
    description: Each record represents a single week, enriched with metrics about balances, payments, refunds, payouts, and other transactions.
    columns:
      - name: week 
        description: The first day of the week associated with the transactions.  The available_at field is used for payouts, and the transaction created_at is used for all others.
      - name: total_sales 
        description: The sum of all sales during the reporting period.
      - name: total_refunds 
        description: The sum of all refunds during the reporting period.
      - name: total_adjustments 
        description: The sum of all adjustments during the reporting period.
      - name: total_other_transactions
        description: The sum of all other transactions during the reporting period.
      - name: total_gross_transaction_amount
        description: Gross amount of all transactions (excluding payouts and transfers)
      - name: total_net_transactions
        description: Net amount of all transactions (excluding payouts and transfers)
      - name: total_payout_fees
        description: Fees associated with all payouts and transfers during the reporting period.
      - name: total_gross_payout_amount 
        description: Total amount of all payouts and transfers during the reporting period.
      - name: weekly_net_activity 
        description: Total balance transaction activity during the reporting period.
      - name: total_sales_count 
        description: Number of sales transactions during the reporting period.
      - name: total_payouts_count 
        description: Number of payouts made during the reporting period.
      - name: total_adjustments_count
        description: Number of adjustments made during the reporting period.
      - name: total_failed_charge_count
        description: Number of incomplete charges during the reporting period.
      - name: total_failed_charge_amount
        description: Total amount from incomplete charges during the reporting period.
 
  - name: stripe__monthly_overview
    description: Each record represents a single month, enriched with metrics about balances, payments, refunds, payouts, and other transactions.
    columns:   
      - name: month 
        description: The first day of the week associated with the transactions.  The available_at field is used for payouts, and the transaction created_at is used for all others.
      - name: total_sales 
        description: The sum of all sales during the reporting period.
      - name: total_refunds 
        description: The sum of all refunds during the reporting period.
      - name: total_adjustments 
        description: The sum of all adjustments during the reporting period.
      - name: total_other_transactions
        description: The sum of all other transactions during the reporting period.
      - name: total_gross_transaction_amount
        description: Gross amount of all transactions (excluding payouts and transfers)
      - name: total_net_transactions
        description: Net amount of all transactions (excluding payouts and transfers)
      - name: total_payout_fees
        description: Fees associated with all payouts and transfers during the reporting period.
      - name: total_gross_payout_amount 
        description: Total amount of all payouts and transfers during the reporting period.
      - name: monthly_net_activity 
        description: Total balance transaction activity during the reporting period.
      - name: total_sales_count 
        description: Number of sales transactions during the reporting period.
      - name: total_payouts_count 
        description: Number of payouts made during the reporting period.
      - name: total_adjustments_count
        description: Number of adjustments made during the reporting period.
      - name: total_failed_charge_count
        description: Number of incomplete charges during the reporting period.
      - name: total_failed_charge_amount
        description: Total amount from incomplete charges during the reporting period.

  - name: stripe__quarterly_overview
    description: Each record represents a single quarter, enriched with metrics about balances, payments, refunds, payouts, and other transactions.
    columns: 
      - name: quarter 
        description: The calendar quarter associated with the transactions.  The available_at field is used for payouts, and the transaction created_at is used for all others.
      - name: total_sales 
        description: The sum of all sales during the reporting period.
      - name: total_refunds 
        description: The sum of all refunds during the reporting period.
      - name: total_adjustments 
        description: The sum of all adjustments during the reporting period.
      - name: total_other_transactions
        description: The sum of all other transactions during the reporting period.
      - name: total_gross_transaction_amount
        description: Gross amount of all transactions (excluding payouts and transfers)
      - name: total_net_transactions
        description: Net amount of all transactions (excluding payouts and transfers)
      - name: total_payout_fees
        description: Fees associated with all payouts and transfers during the reporting period.
      - name: total_gross_payout_amount 
        description: Total amount of all payouts and transfers during the reporting period.
      - name: quarterly_net_activity 
        description: Total balance transaction activity during the reporting period.
      - name: total_sales_count 
        description: Number of sales transactions during the reporting period.
      - name: total_payouts_count 
        description: Number of payouts made during the reporting period.
      - name: total_adjustments_count
        description: Number of adjustments made during the reporting period.
      - name: total_failed_charge_count
        description: Number of incomplete charges during the reporting period.
      - name: total_failed_charge_amount
        description: Total amount from incomplete charges during the reporting period.


  - name: stripe__invoice_line_items
    description: Each record represents an invoice line item, enriched with details about the associated charge, customer, subscription, and plan.
    columns:
      - name: invoice_id 
        description: The unique Identifier of the invoice object. Note invoices can have many line items, so this value can appear multiple times.
      - name: number 
        description: A unique, identifying string that appears on emails sent to the customer for this invoice. This starts with the customer’s unique invoice_prefix if it is specified.
      - name: invoice_created_at 
        description: Timestamp of when the invoice was created.
      - name: status 
        description: Current status of the invoice.
      - name: due_date 
        description: Date when payment for the invoice is due.
      - name: amount_due 
        description: The amount that the invoice is for. Because this query includes line item details, this amount may be repeated.
      - name: subtotal 
        description: The amount of the invoice before discounts and taxes.
      - name: tax 
        description: The amount of tax being charged in the invoice.
      - name: total 
        description: The Total after discounts and taxes.
      - name: amount_paid 
        description: The amount, if any, that the customer has paid on the invoice
      - name: amount_remaining 
        description: The amount of the invoice remaining to be paid.
      - name: attempt_count 
        description: Number of payment attempts made for this invoice, from the perspective of the payment retry schedule.
      - name: invoice_memo 
        description: An arbitrary string attached to the object. Often useful for displaying to users.
      - name: invoice_line_item_id 
        description: The unique Identifier of the invoice line object.
        tests:
          - unique
      - name: line_item_desc 
        description: The description of the invoice line item
      - name: line_item_amount 
        description: The amount for the line item.
      - name: quantity 
        description: The quantity of the line item.
      - name: balance_transaction_id 
        description: The ID of the balance transaction object representing payment
      - name: charge_amount 
        description: The amount charged to the customer.
      - name: charge_status 
        description: The status of the charge for the invoice.
      - name: charge_created_at 
        description: When the charge for the invoice was created.
      - name: customer_description 
        description: Description of the customer.
      - name: customer_email 
        description: Email of the customer.
      - name: subscription_id 
        description: ID of the subscription this invoice relates to.
      - name: subscription_billing 
        description: How the subscription is billed
      - name: subscription_start_date 
        description: The start date of the subscription
      - name: subscription_ended_at 
        description: The end date of the subscription
      - name: period_start
        description: Timestamp of the start of the period.
      - name: period_end
        description: Timestamp of the end of the period.
      - name: customer_id
        description: The associated customer reference.
      - name: plan_id
        description: The ID of the plan of the subscription, if the line item is a subscription or a proration.
      - name: plan_is_active
        description: Boolean indicating if the plan is active (true) or in-active (false).
      - name: plan_amount
        description: The unit amount in cents to be charged, represented as a whole integer if possible.
      - name: plan_interval
        description: The frequency at which a subscription is billed. One of day, week, month or year.
      - name: plan_interval_count
        description: The number of intervals between subscription billings. For example, interval_count=3 bills every 3 months.
      - name: plan_nickname
        description: A brief description of the plan, hidden from customers.
      - name: plan_product_id
        description: Reference to the product whose pricing this plan determines.


  - name: stripe__subscription_line_items
    description: Each record represents a subscription invoice line item, enriched with details about the associated charge, customer, subscription, and plan. Use this table as the starting point for your company-specific churn and MRR calculations.
    columns:
      - name: invoice_id 
        description: The unique Identifier of the invoice object. Note invoices can have many line items, so this value can appear multiple times.
      - name: number 
        description: A unique, identifying string that appears on emails sent to the customer for this invoice. This starts with the customer’s unique invoice_prefix if it is specified.
      - name: invoice_created_at 
        description: Timestamp of when the invoice was created.
      - name: status 
        description: Current status of the invoice.
      - name: due_date 
        description: Date when payment for the invoice is due.
      - name: amount_due 
        description: The amount that the invoice is for. Because this query includes line item details, this amount may be repeated.
      - name: subtotal 
        description: The amount of the invoice before discounts and taxes.
      - name: tax 
        description: The amount of tax being charged in the invoice.
      - name: total 
        description: The Total after discounts and taxes.
      - name: amount_paid 
        description: The amount, if any, that the customer has paid on the invoice
      - name: amount_remaining 
        description: The amount of the invoice remaining to be paid.
      - name: attempt_count 
        description: Number of payment attempts made for this invoice, from the perspective of the payment retry schedule.
      - name: invoice_memo 
        description: An arbitrary string attached to the object. Often useful for displaying to users.
      - name: invoice_line_item_id 
        description: The unique Identifier of the invoice line object.
        tests:
          - unique
      - name: line_item_desc 
        description: The description of the invoice line item
      - name: line_item_amount 
        description: The amount for the line item.
      - name: quantity 
        description: The quantity of the line item.
      - name: balance_transaction_id 
        description: The ID of the balance transaction object representing payment
      - name: charge_amount 
        description: The amount charged to the customer.
      - name: charge_status 
        description: The status of the charge for the invoice.
      - name: charge_created_at 
        description: When the charge for the invoice was created.
      - name: customer_description 
        description: Description of the customer.
      - name: customer_email 
        description: Email of the customer.
      - name: subscription_id 
        description: ID of the subscription this invoice relates to.
      - name: subscription_billing 
        description: How the subscription is billed
      - name: subscription_start_date 
        description: The start date of the subscription
      - name: subscription_ended_at 
        description: The end date of the subscription
      - name: period_start
        description: Timestamp of the start of the period.
      - name: period_end
        description: Timestamp of the end of the period.
      - name: customer_id
        description: The associated customer reference.
      - name: plan_id
        description: The ID of the plan of the subscription, if the line item is a subscription or a proration.
      - name: plan_is_active
        description: Boolean indicating if the plan is active (true) or in-active (false).
      - name: plan_amount
        description: The unit amount in cents to be charged, represented as a whole integer if possible.
      - name: plan_interval
        description: The frequency at which a subscription is billed. One of day, week, month or year.
      - name: plan_interval_count
        description: The number of intervals between subscription billings. For example, interval_count=3 bills every 3 months.
      - name: plan_nickname
        description: A brief description of the plan, hidden from customers.
      - name: plan_product_id
        description: Reference to the product whose pricing this plan determines.

  - name: stripe__subscription_details
    description: Each record represents a subscription, enriched with customer details and payment aggregations.
    columns:
      - name: subscription_id 
        description: Unique identifier for the subscription object.
        tests:
          - unique
      - name: customer_id 
        description: ID of the customer who owns the subscription.
      - name: customer_description 
        description: Description of the customer who owns the subscription.
      - name: customer_email 
        description: Email of the customer who owns the subscription.
      - name: status 
        description: Possible values are incomplete, incomplete_expired, trialing, active, past_due, canceled, or unpaid.
      - name: start_date 
        description: Date when the subscription was first created. The date might differ from the created date due to backdating.
      - name: ended_at 
        description: If the subscription has ended, the date the subscription ended.
      - name: billing 
        description: How the description is billed.
      - name: billing_cycle_anchor 
        description: Determines the date of the first full invoice, and, for plans with month or year intervals, the day of the month for subsequent invoices.
      - name: canceled_at 
        description: If the subscription has been canceled, the date of that cancellation. If the subscription was canceled with cancel_at_period_end, canceled_at will still reflect the date of the initial cancellation request, not the end of the subscription period when the subscription is automatically moved to a canceled state.
      - name: created_at 
        description: Time at which the subscription object was created.
      - name: current_period_start 
        description: Start of the current period that the subscription has been invoiced for.
      - name: current_period_end 
        description: End of the current period that the subscription has been invoiced for. At the end of this period, a new invoice will be created.
      - name: days_until_due 
        description: Number of days a customer has to pay invoices generated by this subscription. This value will be null for subscriptions where collection_method=charge_automatically.
      - name: is_cancel_at_period_end 
        description: If the subscription has been canceled with the at_period_end flag set to true, cancel_at_period_end on the subscription will be true. You can use this attribute to determine whether a subscription that has a status of active is scheduled to be canceled at the end of the current period.
      - name: cancel_at 
        description: A date in the future at which the subscription will automatically get canceled
      - name: number_invoices_generated 
        description: Number of invoices that have been generated for this subscription.
      - name: total_amount_billed 
        description: The total amount that has been billed to the customer for this subscription.
      - name: total_amount_paid 
        description: The total amount paid by the customer for this subscription.
      - name: total_amount_remaining 
        description: Any outstanding balance for invoices related to this subscription.
      - name: most_recent_invoice_created_at 
        description: The timestamp of the most recent invoice for this subscription created.
      - name: average_invoice_amount 
        description: The average amount of invoices generated for this subscription
      - name: average_line_item_amount 
        description: The average sum of the line items for invoices generated for this subscription
      - name: avg_num_invoice_items 
        description: The average number of line items for invoices generated for this subscription   
